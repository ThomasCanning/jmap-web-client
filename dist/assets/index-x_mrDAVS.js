import{j as e,r as c,u as v}from"./index-BURhTyEY.js";import{h as f,i as b,u as h,C as j,a as w,b as y,c as N,d as P,A as C,e as E,f as S,B as L,j as A,k as D}from"./alert-B2XfyHqZ.js";function p({className:a,type:s,...r}){return e.jsx("input",{type:s,"data-slot":"input",className:f("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",a),...r})}var M=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],k=M.reduce((a,s)=>{const r=b(`Primitive.${s}`),o=c.forwardRef((u,t)=>{const{asChild:d,...i}=u,m=d?r:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(m,{...i,ref:t})});return o.displayName=`Primitive.${s}`,{...a,[s]:o}},{}),B="Label",g=c.forwardRef((a,s)=>e.jsx(k.label,{...a,ref:s,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(a.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));g.displayName=B;var F=g;function x({className:a,...s}){return e.jsx(F,{"data-slot":"label",className:f("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",a),...s})}function q(){const a=v(),[s,r]=c.useState(""),[o,u]=c.useState(""),[t,d]=c.useState({}),i=h({mutationFn:({email:l,password:n})=>D(l,n),onSuccess:()=>{a({to:"/session"})}}),m=async l=>{l.preventDefault();const n={};if(s.trim()||(n.email="Email or username is required"),o||(n.password="Password is required"),Object.keys(n).length>0){d(n);return}d({}),i.mutate({email:s,password:o})};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"JMAP Login"}),e.jsx("p",{className:"text-muted-foreground",children:"Sign in to your JMAP server"})]}),e.jsxs(j,{children:[e.jsxs(w,{children:[e.jsx(y,{children:"Login"}),e.jsx(N,{children:"Enter your credentials to continue"})]}),e.jsxs("form",{onSubmit:m,children:[e.jsxs(P,{className:"space-y-4 pb-6",children:[i.isError&&e.jsx(C,{variant:"destructive",children:e.jsx(E,{children:i.error instanceof Error?i.error.message:"Login failed"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"email",children:"Email / Username"}),e.jsx(p,{id:"email",type:"text",value:s,onChange:l=>{r(l.target.value),t.email&&d(n=>({...n,email:void 0}))},disabled:i.isPending,placeholder:"user@example.com",autoComplete:"username","aria-invalid":!!t.email}),t.email&&e.jsx("p",{className:"text-sm text-destructive",children:t.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"password",children:"Password"}),e.jsx(p,{id:"password",type:"password",value:o,onChange:l=>{u(l.target.value),t.password&&d(n=>({...n,password:void 0}))},disabled:i.isPending,placeholder:"Enter your password",autoComplete:"current-password","aria-invalid":!!t.password}),t.password&&e.jsx("p",{className:"text-sm text-destructive",children:t.password})]})]}),e.jsx(S,{className:"pt-0",children:e.jsx(L,{type:"submit",disabled:i.isPending,className:"w-full",children:i.isPending?"Logging in...":"Login"})})]})]}),e.jsxs("div",{className:"text-center text-xs text-muted-foreground",children:["API Base: ",e.jsx("code",{className:"bg-muted px-1 py-0.5 rounded",children:A()})]})]})})}export{q as component};
